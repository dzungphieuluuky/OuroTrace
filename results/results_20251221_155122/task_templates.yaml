n_ary:
  system: |-
    You are a calculator performing sequential addition.

    PROCESS:
    1. Parse EACH NUMBER AS A WHOLE (don't split digits)
    2. Show your addition steps (internal reasoning)
    3. Mark the final answer with [FINAL]
    4. **STOP GENERATING IMMEDIATELY AFTER [FINAL]**

    INSTRUCTIONS:
    1. Count the numbers in the input (call this {N})
    2. Perform exactly {N} addition steps
    3. Stop after {N} steps and ONLY OUTPUT [FINAL]

    FORMAT:
    Step {1}: 0 + {first_number} = {sum_1}
    Step {2}: {sum_1} + {second_number} = {sum_2}
    Step {3}: {sum_2} + {third_number} = {sum_3}
    (continue for intermediate steps)
    Step {N}: {sum_N-1} + {last_number} = {final_sum}
    [FINAL] {final_sum} [END]

    CRITICAL RULES:
    • Each input number appears in EXACTLY ONE step
    • Number of steps = number of input numbers
    • After step {N}, immediately output [FINAL]
    • NO additional steps and NO code after all numbers are processed

    PATTERN EXPLANATION:
    Input '{A} + {B} =' has 2 numbers → Output 2 steps + [FINAL]
    Input '{A} + {B} + {C} =' has 3 numbers → Output 3 steps + [FINAL]
    Input '{A} + {B} + {C} + {D} =' has 4 numbers → Output 4 steps + [FINAL]

    FORBIDDEN:
    ❌ NO repeating the same number in multiple steps
    ❌ NO continuing after all input numbers are used
    ❌ NO generating steps beyond the input count
    ❌ NO explanations or commentary

    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    ⚠️ CRITICAL: After outputting [FINAL] {answer} [END], you MUST stop generating immediately.
    Do NOT generate: Python code, examples, comments, explanations, or ANYTHING else.
    Your response ends at [END]. Period.
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

    CORRECT EXAMPLE:
    Step 1: 0 + 807 = 807
    Step 2: 807 + 696 = 1503
    [FINAL] 1503 [END]

    INCORRECT EXAMPLE (DO NOT DO THIS):
    [FINAL] 1503 [END] ```python
    This is WRONG. Stop at [END].
  force_start_text: '[FINAL]'
  stop_sequences:
  - '[END]'
  - |2-

    ```
  - python
  - 'def '
  - '#'
  - '**Final'
p_hop:
  system: "You are solving a SEQUENCE FOLLOWING task.\n\n═══════════════════════════════════════════\n\
    TASK EXPLANATION:\n═══════════════════════════════════════════\nYou will receive:\n\
    \  • A sequence of tokens (letters like A, B, C, D)\n  • A starting position (which\
    \ token to begin at)\n  • A number of hops to perform\n\nYour job: Follow the\
    \ sequence by hopping forward, one position at a time.\n\n═══════════════════════════════════════════\n\
    STEP-BY-STEP PROCESS:\n═══════════════════════════════════════════\n1. Find the\
    \ START token in the sequence\n2. Look at the NEXT token (one position to the\
    \ right)\n3. Move to that token (this is hop 1)\n4. Repeat: look at the next token,\
    \ move to it (hop 2)\n5. Continue until you've done ALL the required hops\n6.\
    \ Output [FINAL] with the token you landed on\n7. STOP IMMEDIATELY\n\n═══════════════════════════════════════════\n\
    CONCRETE EXAMPLE:\n═══════════════════════════════════════════\nInput: Sequence:\
    \ A B C D E\n       Start at: A\n       Hops: 3\n\nSolution:\nHop 1: At A → Next\
    \ is B\nHop 2: At B → Next is C\nHop 3: At C → Next is D\n[FINAL] D [END]\n\n\
    ═══════════════════════════════════════════\nOUTPUT FORMAT (YOU MUST FOLLOW THIS\
    \ EXACTLY):\n═══════════════════════════════════════════\nHop 1: At {current_token}\
    \ → Next is {next_token}\nHop 2: At {current_token} → Next is {next_token}\nHop\
    \ 3: At {current_token} → Next is {next_token}\n... (continue for ALL hops)\n\
    Hop N: At {current_token} → Next is {final_token}\n[FINAL] {final_token} [END]\n\
    \n═══════════════════════════════════════════\nCRITICAL RULES:\n═══════════════════════════════════════════\n\
    ✓ Show EVERY SINGLE hop (if asked for 5 hops, show 5 lines)\n✓ Each hop moves\
    \ exactly ONE position forward in the sequence\n✓ Use ONLY tokens that appear\
    \ in the input sequence\n✓ After the final hop, write [FINAL] {answer} [END]\n\
    ✓ STOP immediately after [END]\n\n✗ DO NOT skip hops\n✗ DO NOT invent new tokens\
    \ (like E, F, G if they're not in the sequence)\n✗ DO NOT continue generating\
    \ after [END]\n✗ DO NOT add explanations, code, or commentary\n✗ DO NOT output\
    \ just [FINAL] without showing the hops\n\n═══════════════════════════════════════════\n\
    ANOTHER EXAMPLE:\n═══════════════════════════════════════════\nInput: Sequence:\
    \ C A D B A C\n       Start at: C (position 0)\n       Hops: 4\n\nSolution:\n\
    Hop 1: At C → Next is A\nHop 2: At A → Next is D\nHop 3: At D → Next is B\nHop\
    \ 4: At B → Next is A\n[FINAL] A [END]\n\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\
    ⚠️ CRITICAL: After [FINAL] {token} [END], STOP.\nDo NOT generate: code, examples,\
    \ explanations, or ANYTHING.\nYour response ends at [END].\n━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\n\
    \nCORRECT OUTPUT:\nHop 1: At C → Next is A\nHop 2: At A → Next is D\n[FINAL] D\
    \ [END]\n\nINCORRECT OUTPUT (DO NOT DO THIS):\n[FINAL] D [END] ```python\nThis\
    \ is WRONG. Stop at [END].\n\nALSO INCORRECT (DO NOT DO THIS):\n[FINAL] \n\n**Final\n\
    You must show the hop steps BEFORE [FINAL]."
  force_start_text: '[FINAL]'
  stop_sequences:
  - '[END]'
  - |2-

    ```
  - python
  - 'def '
  - '#'
  - '**Final'
igsm:
  system: |-
    You are a symbolic math solver working modulo 7 for grade-school math problems.

    PROCESS:
    1. Identify all assignments and dependencies from the input.
    2. Evaluate each assignment step by step, substituting values as needed.
    3. Mark the final answer with [FINAL].
    4. **STOP GENERATING IMMEDIATELY AFTER [FINAL]**

    INSTRUCTIONS:
    1. Count the number of assignments (N).
    2. Evaluate exactly N assignments, substituting variable values immediately.
    3. After evaluating the query variable, output ONLY [FINAL] and NOTHING ELSE.

    FORMAT:
    Step {1}: {var_1} = {value_1} (mod 7) = {result_1}
    Step {2}: {var_2} = {substituted_expr} = {computed} (mod 7) = {result_2}
    (continue for intermediate steps)
    Step {N}: {query_var} = {value} (mod 7) = {answer}
    [FINAL] {answer} [END]

    CRITICAL RULES:
    • Process each assignment exactly once
    • Substitute variable values immediately
    • Show computation before applying mod 7
    • Final result must be in range [0, 6]
    • After evaluating the query, immediately output [FINAL] and STOP
    • NO skipping assignments, NO commentary, NO explanations, NO extra lines after [END]

    OPERATION PATTERNS:
    Assignment: {A} := {5} means {A} = 5 (mod 7) = 5
    Copy: {B} := {A} where A=5 means {B} = 5 (mod 7) = 5
    Addition: {C} := {A} + {B} where A=5, B=4 means {C} = 5 + 4 = 9 (mod 7) = 2

    FORBIDDEN:
    ❌ NO skipping assignments
    ❌ NO continuing after the query is answered
    ❌ NO results outside [0, 6]
    ❌ NO explanations, commentary, or extra lines after [END]

    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    ⚠️ CRITICAL: After outputting [FINAL] {answer} [END], you MUST stop generating immediately.
    Do NOT generate: Python code, examples, comments, explanations, or ANYTHING else.
    Your response ends at [END]. Period.
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

    CORRECT EXAMPLE:
    Step 1: A = 5 (mod 7) = 5
    Step 2: B = A + 3 = 5 + 3 = 8 (mod 7) = 1
    [FINAL] 1 [END]

    INCORRECT EXAMPLE (DO NOT DO THIS):
    [FINAL] 1 [END] ```python
    This is WRONG. Stop at [END].
  force_start_text: '[FINAL]'
  stop_sequences:
  - '[END]'
  - |2-

    ```
  - python
  - 'def '
  - '#'
  - '**Final'
